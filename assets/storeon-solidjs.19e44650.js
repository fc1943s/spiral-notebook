import{$ as A,e as R,g as E,f as W,h as q,o as L,i as V,j as X,k as Y}from"./solid-js.eba58a93.js";const N=Symbol("store-raw"),g=Symbol("store-node"),B=Symbol("store-name");function T(n,e){let i=n[A];if(!i&&(Object.defineProperty(n,A,{value:i=new Proxy(n,J)}),!Array.isArray(n))){const t=Object.keys(n),f=Object.getOwnPropertyDescriptors(n);for(let o=0,l=t.length;o<l;o++){const c=t[o];if(f[c].get){const r=f[c].get.bind(i);Object.defineProperty(n,c,{get:r})}}}return i}function O(n){let e;return n!=null&&typeof n=="object"&&(n[A]||!(e=Object.getPrototypeOf(n))||e===Object.prototype||Array.isArray(n))}function P(n,e=new Set){let i,t,f,o;if(i=n!=null&&n[N])return i;if(!O(n)||e.has(n))return n;if(Array.isArray(n)){Object.isFrozen(n)?n=n.slice(0):e.add(n);for(let l=0,c=n.length;l<c;l++)f=n[l],(t=P(f,e))!==f&&(n[l]=t)}else{Object.isFrozen(n)?n=Object.assign({},n):e.add(n);const l=Object.keys(n),c=Object.getOwnPropertyDescriptors(n);for(let r=0,s=l.length;r<s;r++)o=l[r],!c[o].get&&(f=n[o],(t=P(f,e))!==f&&(n[o]=t))}return n}function _(n){let e=n[g];return e||Object.defineProperty(n,g,{value:e={}}),e}function C(n,e,i){return n[e]||(n[e]=z(i))}function G(n,e){const i=Reflect.getOwnPropertyDescriptor(n,e);return!i||i.get||!i.configurable||e===A||e===g||e===B||(delete i.value,delete i.writable,i.get=()=>n[A][e]),i}function M(n){if(E()){const e=_(n);(e._||(e._=z()))()}}function H(n){return M(n),Reflect.ownKeys(n)}function z(n){const[e,i]=q(n,{equals:!1,internal:!0});return e.$=i,e}const J={get(n,e,i){if(e===N)return n;if(e===A)return i;if(e===R)return M(n),i;const t=_(n),f=t.hasOwnProperty(e);let o=f?t[e]():n[e];if(e===g||e==="__proto__")return o;if(!f){const l=Object.getOwnPropertyDescriptor(n,e);E()&&(typeof o!="function"||n.hasOwnProperty(e))&&!(l&&l.get)&&(o=C(t,e,o)())}return O(o)?T(o):o},has(n,e){if(e===N||e===A||e===R||e===g||e==="__proto__")return!0;const i=_(n)[e];return i&&i(),e in n},set(){return!0},deleteProperty(){return!0},ownKeys:H,getOwnPropertyDescriptor:G};function h(n,e,i,t=!1){if(!t&&n[e]===i)return;const f=n[e],o=n.length;i===void 0?delete n[e]:n[e]=i;let l=_(n),c;(c=C(l,e,f))&&c.$(()=>i),Array.isArray(n)&&n.length!==o&&(c=C(l,"length",o))&&c.$(n.length),(c=l._)&&c.$()}function F(n,e){const i=Object.keys(e);for(let t=0;t<i.length;t+=1){const f=i[t];h(n,f,e[f])}}function Q(n,e){if(typeof e=="function"&&(e=e(n)),e=P(e),Array.isArray(e)){if(n===e)return;let i=0,t=e.length;for(;i<t;i++){const f=e[i];n[i]!==f&&h(n,i,f)}h(n,"length",t)}else F(n,e)}function j(n,e,i=[]){let t,f=n;if(e.length>1){t=e.shift();const l=typeof t,c=Array.isArray(n);if(Array.isArray(t)){for(let r=0;r<t.length;r++)j(n,[t[r]].concat(e),i);return}else if(c&&l==="function"){for(let r=0;r<n.length;r++)t(n[r],r)&&j(n,[r].concat(e),i);return}else if(c&&l==="object"){const{from:r=0,to:s=n.length-1,by:u=1}=t;for(let d=r;d<=s;d+=u)j(n,[d].concat(e),i);return}else if(e.length>1){j(n[t],e,[t].concat(i));return}f=n[t],i=[t].concat(i)}let o=e[0];typeof o=="function"&&(o=o(f,i),o===f)||t===void 0&&o==null||(o=P(o),t===void 0||O(f)&&O(o)&&!Array.isArray(o)?F(f,o):h(n,t,o))}function U(...[n,e]){const i=P(n||{}),t=Array.isArray(i),f=T(i);function o(...l){W(()=>{t&&l.length===1?Q(i,l[0]):j(i,l)})}return[f,o]}const K=Symbol("store-root");function y(n,e,i,t,f){const o=e[i];if(n===o)return;if(!O(n)||!O(o)||f&&n[f]!==o[f]){if(n!==o){if(i===K)return n;h(e,i,n)}return}if(Array.isArray(n)){if(n.length&&o.length&&(!t||f&&n[0][f]!=null)){let r,s,u,d,a,b,D,w;for(u=0,d=Math.min(o.length,n.length);u<d&&(o[u]===n[u]||f&&o[u][f]===n[u][f]);u++)y(n[u],o,u,t,f);const S=new Array(n.length),$=new Map;for(d=o.length-1,a=n.length-1;d>=u&&a>=u&&(o[d]===n[a]||f&&o[d][f]===n[a][f]);d--,a--)S[a]=o[d];if(u>a||u>d){for(s=u;s<=a;s++)h(o,s,n[s]);for(;s<n.length;s++)h(o,s,S[s]),y(n[s],o,s,t,f);o.length>n.length&&h(o,"length",n.length);return}for(D=new Array(a+1),s=a;s>=u;s--)b=n[s],w=f?b[f]:b,r=$.get(w),D[s]=r===void 0?-1:r,$.set(w,s);for(r=u;r<=d;r++)b=o[r],w=f?b[f]:b,s=$.get(w),s!==void 0&&s!==-1&&(S[s]=o[r],s=D[s],$.set(w,s));for(s=u;s<n.length;s++)s in S?(h(o,s,S[s]),y(n[s],o,s,t,f)):h(o,s,n[s])}else for(let r=0,s=n.length;r<s;r++)y(n[r],o,r,t,f);o.length>n.length&&h(o,"length",n.length);return}const l=Object.keys(n);for(let r=0,s=l.length;r<s;r++)y(n[l[r]],o,l[r],t,f);const c=Object.keys(o);for(let r=0,s=c.length;r<s;r++)n[c[r]]===void 0&&h(o,c[r],void 0)}function Z(n,e={}){const{merge:i,key:t="id"}=e,f=P(n);return o=>{if(!O(o)||!O(f))return f;const l=y(f,{[K]:o},K,i,t);return l===void 0?o:l}}const I=X();function p(n){let[e,i]=U(n.store.get()),t=n.store.on("@changed",(f,o)=>{Object.keys(o).forEach(l=>{i(l,Z(o[l]))})});return L(()=>t()),V(I.Provider,{value:[e,n.store.dispatch],children:()=>n.children})}function v(){return Y(I)}export{p as S,U as c,v as u};
